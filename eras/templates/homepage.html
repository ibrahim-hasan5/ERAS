{% load static %}
{% load disasters_tags %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ERAS</title>
    <!-- Favicon - you can replace this with your own -->
    <link rel="icon" href="{% static 'assets/img/logo.jpg' %}">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts for "Inter" -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
   <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <style>
        .mobile-menu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
        }
        .mobile-menu.active {
            max-height: 500px;
        }
        .hamburger span {
            display: block;
            width: 25px;
            height: 3px;
            background-color: #374151;
            margin: 5px 0;
            transition: 0.3s;
        }
        .hamburger.active span:nth-child(1) {
            transform: rotate(-45deg) translate(-5px, 6px);
        }
        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }
        .hamburger.active span:nth-child(3) {
            transform: rotate(45deg) translate(-5px, -6px);
        }
    </style>

</head>

<body class="bg-gray-100 text-gray-800">
    {% if user.is_authenticated and user.user_type == 'citizen' and not user.citizen_profile.blood_group %}
    <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 fixed top-16 left-0 right-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <p class="font-bold">Complete Your Profile</p>
            <a href="{% url 'citizen_profile_setup' %}" class="bg-custom-red text-white py-1 px-3 rounded text-sm hover:bg-red-700">Complete Now</a>
        </div>
    </div>
    {% endif %}

    <!-- Header & Navigation -->
    <header class="bg-white shadow-md fixed w-full top-0 left-0 z-50">
        <nav class="container mx-auto px-6 py-4">
            <!-- Top Row: Logo and Mobile Menu Button -->
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-2">
                    <img src="{% static 'assets/img/logo.jpg' %}" alt="Logo" class="w-8 h-8">
                    <span class="text-xl font-bold text-gray-800">ERAS</span>
                </div>

                <!-- Desktop Navigation Links -->
                <div class="hidden md:flex items-center space-x-6">
                    <a href="{% url 'homepage' %}" class="text-gray-600 hover:text-custom-red transition duration-300">üè†Home</a>
                    <a href="{% url 'disasters:disaster_list' %}" class="text-gray-600 hover:text-custom-red transition duration-300">üö®Alert</a>
                    <a href="{% url 'blood_network' %}" class="text-gray-600 hover:text-custom-red transition duration-300">ü©∏Blood Network</a>
                    <a href="{% url 'service_provider_directory' %}" class="text-gray-600 hover:text-custom-red transition duration-300">üõ†Ô∏èServices</a>
                    {% if user.is_authenticated and user.user_type == 'citizen' %}
                        <a href="{% url 'citizen_dashboard' %}" class="text-gray-600 hover:text-custom-red transition duration-300">üìäDashboard</a>
                    {% elif user.is_authenticated and user.user_type == 'service_provider' %}
                        <a href="{% url 'service_provider_dashboard' %}" class="text-gray-600 hover:text-custom-red transition duration-300">üìäDashboard</a>
                    {% endif %}
                </div>

                <!-- Desktop Auth Buttons -->
                <div class="hidden md:flex items-center space-x-4">
                    {% if user.is_authenticated %}
                        <span class="text-gray-600">Welcome, {{ user.username }}</span>
                        <a href="{% url 'logout' %}" class="bg-custom-red text-white py-2 px-4 rounded-full shadow-lg hover:bg-red-700 transition duration-300">Logout</a>
                    {% else %}
                        <a href="{% url 'login' %}" class="text-gray-600 hover:text-custom-red transition duration-300">Login</a>
                        <a href="{% url 'register_choice' %}" class="bg-custom-red text-white py-2 px-4 rounded-full shadow-lg hover:bg-red-700 transition duration-300">Register</a>
                    {% endif %}
                </div>

                <!-- Mobile Menu Button -->
                <button class="md:hidden hamburger" id="mobileMenuBtn">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>

            <!-- Mobile Menu -->
            <div class="mobile-menu md:hidden" id="mobileMenu">
                <div class="pt-4 pb-3 space-y-1">
                    <a href="{% url 'homepage' %}" class="block px-3 py-2 text-gray-600 hover:text-custom-red hover:bg-gray-50 rounded-md transition duration-300">
                        <i class="fas fa-home w-5 mr-2"></i>Home
                    </a>
                    <a href="{% url 'disasters:disaster_list' %}" class="block px-3 py-2 text-gray-600 hover:text-custom-red hover:bg-gray-50 rounded-md transition duration-300">
                        <i class="fas fa-exclamation-triangle w-5 mr-2"></i>Alerts
                    </a>
                    <a href="{% url 'blood_network' %}" class="block px-3 py-2 text-gray-600 hover:text-custom-red hover:bg-gray-50 rounded-md transition duration-300">
                        <i class="fas fa-tint w-5 mr-2"></i>Blood Network
                    </a>
                    <a href="{% url 'service_provider_directory' %}" class="block px-3 py-2 text-gray-600 hover:text-custom-red hover:bg-gray-50 rounded-md transition duration-300">
                        <i class="fas fa-hospital w-5 mr-2"></i>Services
                    </a>
                    {% if user.is_authenticated and user.user_type == 'citizen' %}
                        <a href="{% url 'citizen_dashboard' %}" class="block px-3 py-2 text-gray-600 hover:text-custom-red hover:bg-gray-50 rounded-md transition duration-300">
                            <i class="fas fa-tachometer-alt w-5 mr-2"></i>Dashboard
                        </a>
                    {% elif user.is_authenticated and user.user_type == 'service_provider' %}
                        <a href="{% url 'service_provider_dashboard' %}" class="block px-3 py-2 text-gray-600 hover:text-custom-red hover:bg-gray-50 rounded-md transition duration-300">
                            <i class="fas fa-tachometer-alt w-5 mr-2"></i>Dashboard
                        </a>
                    {% endif %}

                    <div class="border-t border-gray-200 my-2"></div>

                    {% if user.is_authenticated %}
                        <div class="px-3 py-2 text-gray-600">
                            <i class="fas fa-user w-5 mr-2"></i>Welcome, {{ user.username }}
                        </div>
                        <a href="{% url 'logout' %}" class="block mx-3 my-2 bg-custom-red text-white text-center py-2 px-4 rounded-full shadow-lg hover:bg-red-700 transition duration-300">
                            <i class="fas fa-sign-out-alt mr-2"></i>Logout
                        </a>
                    {% else %}
                        <a href="{% url 'login' %}" class="block px-3 py-2 text-gray-600 hover:text-custom-red hover:bg-gray-50 rounded-md transition duration-300">
                            <i class="fas fa-sign-in-alt w-5 mr-2"></i>Login
                        </a>
                        <a href="{% url 'register_choice' %}" class="block mx-3 my-2 bg-custom-red text-white text-center py-2 px-4 rounded-full shadow-lg hover:bg-red-700 transition duration-300">
                            <i class="fas fa-user-plus mr-2"></i>Register
                        </a>
                    {% endif %}
                </div>
            </div>
        </nav>
    </header>

    <main>
        <!-- jump in Section -->
        <section class="hero-section text-center flex flex-col items-center justify-center p-8 mt-16">
            <video
                autoplay
                muted
                loop
                playsinline
                class="absolute top-0 left-0 w-full h-full object-cover"
            >
                <source src="{% static 'assets/videos/emergency-hero-bg.mp4' %}" type="video/mp4">
                <source src="{% static 'assets/videos/emergency-hero-bg.webm' %}" type="video/webm">
                <!-- Fallback for browsers that don't support video -->
                Your browser does not support the video tag.
            </video>
            <div class="z-10">
                <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold leading-tight">Instant Alerts That Save Lives</h1>
                <p class="mt-4 text-lg sm:text-xl max-w-2xl mx-auto">Get notified, act fast, stay safe. For every fire, flood, and crisis ‚Äì we‚Äôre ready.</p>
                <div class="mt-12 flex flex-col sm:flex-row items-center justify-center space-y-8 sm:space-y-0 sm:space-x-12">
                    <div class="flex flex-col items-center">
                        <span class="text-4xl font-bold">24/7</span>
                        <span class="text-sm">Emergency Monitoring</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <span class="text-4xl font-bold">5M+</span>
                        <span class="text-sm">Citizens Protected</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <span class="text-4xl font-bold">&lt;5min</span>
                        <span class="text-sm">Alert Response Time</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Live Emergency Alerts Section -->
       <section class="container mx-auto px-6 py-16">
    <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-900">Live Emergency Alerts</h2>
        <p class="mt-2 text-gray-600">View real-time, verified emergency alerts in your area.</p>
    </div>

    {% load disasters_tags %}
    {% get_recent_disasters as recent_disasters %}

    {% if recent_disasters %}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {% for disaster in recent_disasters %}
                <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col hover:shadow-2xl transition-shadow duration-300">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-gradient-to-br from-red-500 to-pink-500 rounded-lg flex items-center justify-center text-white">
                                <i class="{{ disaster.get_disaster_icon }}"></i>
                            </div>
                            <div>
                                <span class="text-lg font-semibold text-custom-red">{{ disaster.get_disaster_type_display }}</span>
                                <div class="text-xs text-gray-500">{{ disaster.get_time_since_reported }}</div>
                            </div>
                        </div>
                        <span class="px-2 py-1 text-xs font-bold rounded-full {{ disaster.get_severity_color }}">
                            {{ disaster.get_severity_display|upper }}
                        </span>
                    </div>

                    <div class="flex items-center text-gray-600 mb-3">
                        <i class="fas fa-map-marker-alt mr-2 text-red-500"></i>
                        <span class="text-sm">{{ disaster.city }}, {{ disaster.area_sector }}</span>
                    </div>

                    <p class="text-gray-700 flex-grow mb-4">{{ disaster.description|truncatechars:100 }}</p>

                    {% if disaster.images.exists %}
                        <div class="mb-4">
                            <img src="{{ disaster.images.first.image.url }}" alt="Disaster image"
                                 class="w-full h-32 object-cover rounded-lg">
                        </div>
                    {% endif %}

                    <div class="flex items-center justify-between">
                        <a href="{% url 'disasters:disaster_detail' disaster.id %}"
                           class="text-custom-red font-semibold hover:underline flex items-center">
                            View Details <i class="fas fa-arrow-right ml-1 text-sm"></i>
                        </a>
                        <div class="flex items-center space-x-2 text-gray-500 text-sm">
                            <i class="fas fa-eye"></i>
                            <span>{{ disaster.view_count }}</span>
                            {% if disaster.responses.exists %}
                                <i class="fas fa-ambulance ml-2"></i>
                                <span>{{ disaster.responses.count }}</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="text-center mt-12">
            <a href="{% url 'disasters:disaster_list' %}"
               class="bg-custom-red text-white py-3 px-8 rounded-full shadow-lg hover:bg-red-700 transition duration-300 font-semibold">
                View All Alerts
            </a>
        </div>
    {% else %}
        <div class="text-center py-12">
            <div class="w-20 h-20 mx-auto mb-6 bg-green-100 rounded-full flex items-center justify-center">
                <i class="fas fa-shield-alt text-3xl text-green-500"></i>
            </div>
            <h3 class="text-xl font-semibold text-gray-700 mb-2">All Clear</h3>
            <p class="text-gray-500 mb-6">No active emergency alerts in your area at the moment.</p>
            {% if user.is_authenticated %}
                <a href="{% url 'disasters:create_disaster' %}"
                   class="bg-custom-red text-white py-2 px-6 rounded-full shadow-lg hover:bg-red-700 transition duration-300 font-semibold">
                    Report Emergency
                </a>
            {% endif %}
        </div>
    {% endif %}
</section>

        <!-- SPRINT 5: Blood Donor Emergency Network -->
        <section class="container mx-auto px-6 py-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900">Blood Donor Emergency Network</h2>
                <p class="mt-2 text-gray-600">Find and connect with blood donors in your area instantly.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">

                <!-- Left Card: Recent Blood Requests -->
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-semibold text-gray-900 flex items-center">
                            <i class="fas fa-exclamation-circle text-red-500 mr-3"></i>
                            Recent Blood Requests
                        </h3>
                        <a href="{% url 'blood_network' %}#feed" class="text-red-500 hover:text-red-700 font-medium text-sm">
                        View All ‚Üí
                        </a>
                    </div>

                    {% if recent_blood_requests %}
                        <div class="space-y-4">
                            {% for request in recent_blood_requests %}
                                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow duration-200">
                                    <div class="flex items-start justify-between">
                                        <div class="flex-1">
                                            <div class="flex items-center space-x-3 mb-2">
                                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-bold bg-red-100 text-red-800">
                                                    {{ request.blood_type_needed }}
                                                </span>
                                                {% if request.urgency == 'urgent' %}
                                                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-bold bg-orange-100 text-orange-800">
                                                        üö® URGENT
                                                    </span>
                                                {% endif %}
                                                <span class="text-xs text-gray-500">
                                                    {{ request.created_at|timesince }} ago
                                                </span>
                                            </div>

                                            <h4 class="font-semibold text-gray-900 mb-1">
                                            {{ request.bags_needed }} bag{{ request.bags_needed|pluralize }} of {{ request.blood_type_needed }} needed for {{ request.patient_name }}
                                            </h4>

                                            <div class="flex items-center text-sm text-gray-600 mb-2">
                                                <i class="fas fa-map-marker-alt mr-1"></i>
                                                {{ request.location }}
                                            </div>

                                            <div class="flex items-center text-sm text-gray-600 mb-3">
                                                <i class="fas fa-calendar-alt mr-1"></i>
                                                Needed by: {{ request.needed_by_date|date:"M d, Y" }}
                                            </div>

                                            <div class="flex items-center space-x-3">
                                                <a href="tel:{{ request.contact_phone }}"
                                                class="inline-flex items-center px-3 py-1 bg-red-500 text-white text-sm rounded-full hover:bg-red-600 transition-colors duration-200">
                                                    <i class="fas fa-phone mr-1"></i>
                                                    Call Now
                                                </a>
                                                <span class="text-sm text-gray-500">
                                                    {{ request.contact_phone }}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-heart text-4xl mb-4 text-gray-300"></i>
                            <p class="mb-4">No active blood requests at the moment</p>
                            <a href="{% url 'blood_network' %}" class="text-red-500 hover:text-red-700 font-medium">
                                Post a Blood Request ‚Üí
                            </a>
                        </div>
                    {% endif %}

                    <div class="mt-6 text-center">
                        <a href="{% url 'blood_network' %}"
                        class="inline-block bg-red-500 text-white py-2 px-6 rounded-full shadow-lg hover:bg-red-600 transition-colors duration-200 font-medium">
                            ü©∏ Need Blood? Post Request
                        </a>
                    </div>
                </div>

                <!-- Right Card: Active Donors -->
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-semibold text-gray-900 flex items-center">
                            <i class="fas fa-user-friends text-green-500 mr-3"></i>
                            Active Donors
                        </h3>
                        <a href="{% url 'blood_network' %}#search" class="text-green-500 hover:text-green-700 font-medium text-sm">
                            View All ‚Üí
                        </a>
                    </div>

                    {% if active_donors %}
                        <div class="space-y-4">
                            {% for donor in active_donors %}
                                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow duration-200">
                                    <div class="flex items-start justify-between">
                                        <div class="flex-1">
                                            <div class="flex items-center space-x-3 mb-2">
                                                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-bold bg-green-100 text-green-800">
                                                    {{ donor.blood_group }}
                                                </span>
                                                {% if donor.emergency_donor %}
                                                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-bold bg-yellow-100 text-yellow-800">
                                                        ‚ö° Emergency
                                                    </span>
                                                {% endif %}
                                            </div>

                                            <h4 class="font-semibold text-gray-900 mb-1">
                                                {{ donor.user.first_name }} {{ donor.user.last_name|first }}.
                                            </h4>

                                            <div class="flex items-center text-sm text-gray-600 mb-2">
                                                <i class="fas fa-map-marker-alt mr-1"></i>
                                                {{ donor.city }}{% if donor.area_sector %}, {{ donor.area_sector }}{% endif %}
                                            </div>

                                            {% if donor.last_blood_donation %}
                                                <div class="flex items-center text-sm text-gray-600 mb-3">
                                                    <i class="fas fa-calendar-check mr-1"></i>
                                                    Last donated: {{ donor.last_blood_donation|date:"M Y" }}
                                                </div>
                                            {% endif %}

                                            <div class="flex items-center space-x-3">
                                                <a href="tel:{{ donor.phone_number }}"
                                                class="inline-flex items-center px-3 py-1 bg-green-500 text-white text-sm rounded-full hover:bg-green-600 transition-colors duration-200">
                                                    <i class="fas fa-phone mr-1"></i>
                                                    Contact
                                                </a>
                                                <span class="text-sm text-gray-500">
                                                    {{ donor.phone_number }}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-users text-4xl mb-4 text-gray-300"></i>
                            <p class="mb-4">No active donors available</p>
                            {% if user.is_authenticated %}
                                <a href="{% url 'citizen_profile_setup' %}" class="text-green-500 hover:text-green-700 font-medium">
                                    Become a Donor ‚Üí
                                </a>
                            {% else %}
                                <a href="{% url 'register_citizen' %}" class="text-green-500 hover:text-green-700 font-medium">
                                    Register to Become a Donor ‚Üí
                                </a>
                            {% endif %}
                        </div>
                    {% endif %}

                    <div class="mt-6 text-center">
                        <a href="{% url 'blood_network' %}#search"
                        class="inline-block bg-green-500 text-white py-2 px-6 rounded-full shadow-lg hover:bg-green-600 transition-colors duration-200 font-medium">
                            üîç Find Blood Donors
                        </a>
                    </div>
                </div>
            </div>

            <!-- Bottom CTA -->
            <div class="text-center mt-12">
                <a href="{% url 'blood_network' %}"
                class="bg-gradient-to-r from-red-500 to-pink-500 text-white py-3 px-8 rounded-full shadow-lg hover:from-red-600 hover:to-pink-600 transition-all duration-300 font-semibold text-lg">
                    ü©∏ Access Full Blood Network
                </a>
            </div>
        </section>

    <!-- Replace the existing Emergency Services Directory section in homepage.html -->
<!-- Emergency Services Directory Section -->
<section class="container mx-auto px-6 py-16">
    <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-900">Emergency Services Directory</h2>
        <p class="mt-2 text-gray-600">Find verified emergency service providers in your area instantly.</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <!-- Service Type 1: Hospital -->
        <a href="{% url 'service_provider_directory' %}?service_type=hospital" class="group">
            <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 transform group-hover:-translate-y-2">
                <i class="fas fa-hospital text-4xl text-red-500 mb-4 group-hover:scale-110 transition-transform duration-300"></i>
                <h3 class="text-lg font-semibold group-hover:text-red-500 transition-colors duration-300">Hospitals</h3>
                <p class="text-gray-600 mt-2 text-sm">Find nearby hospitals and medical facilities for emergency medical care.</p>
                <div class="mt-4 bg-red-100 text-red-600 py-1 px-3 rounded-full text-xs font-medium inline-block">
                    <i class="fas fa-search mr-1"></i> Find Now
                </div>
            </div>
        </a>

        <!-- Service Type 2: Ambulance -->
        <a href="{% url 'service_provider_directory' %}?service_type=ambulance" class="group">
            <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 transform group-hover:-translate-y-2">
                <i class="fas fa-ambulance text-4xl text-green-500 mb-4 group-hover:scale-110 transition-transform duration-300"></i>
                <h3 class="text-lg font-semibold group-hover:text-green-500 transition-colors duration-300">Ambulance Services</h3>
                <p class="text-gray-600 mt-2 text-sm">Find ambulance services and emergency medical transportation near you.</p>
                <div class="mt-4 bg-green-100 text-green-600 py-1 px-3 rounded-full text-xs font-medium inline-block">
                    <i class="fas fa-search mr-1"></i> Find Now
                </div>
            </div>
        </a>

        <!-- Service Type 3: Fire Station -->
        <a href="{% url 'service_provider_directory' %}?service_type=fire_station" class="group">
            <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 transform group-hover:-translate-y-2">
                <i class="fas fa-fire-extinguisher text-4xl text-orange-500 mb-4 group-hover:scale-110 transition-transform duration-300"></i>
                <h3 class="text-lg font-semibold group-hover:text-orange-500 transition-colors duration-300">Fire Stations</h3>
                <p class="text-gray-600 mt-2 text-sm">Connect with fire departments and emergency response units in your area.</p>
                <div class="mt-4 bg-orange-100 text-orange-600 py-1 px-3 rounded-full text-xs font-medium inline-block">
                    <i class="fas fa-search mr-1"></i> Find Now
                </div>
            </div>
        </a>

        <!-- Service Type 4: Police Station -->
        <a href="{% url 'service_provider_directory' %}?service_type=police_station" class="group">
            <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 transform group-hover:-translate-y-2">
                <i class="fas fa-shield-alt text-4xl text-blue-500 mb-4 group-hover:scale-110 transition-transform duration-300"></i>
                <h3 class="text-lg font-semibold group-hover:text-blue-500 transition-colors duration-300">Police Stations</h3>
                <p class="text-gray-600 mt-2 text-sm">Locate police stations and law enforcement agencies near you.</p>
                <div class="mt-4 bg-blue-100 text-blue-600 py-1 px-3 rounded-full text-xs font-medium inline-block">
                    <i class="fas fa-search mr-1"></i> Find Now
                </div>
            </div>
        </a>

        <!-- Service Type 5: Military Camp -->
        <a href="{% url 'service_provider_directory' %}?service_type=military_camp" class="group">
            <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 transform group-hover:-translate-y-2">
                <i class="fas fa-campground text-4xl text-gray-700 mb-4 group-hover:scale-110 transition-transform duration-300"></i>
                <h3 class="text-lg font-semibold group-hover:text-gray-700 transition-colors duration-300">Military Camps</h3>
                <p class="text-gray-600 mt-2 text-sm">Access military facilities and defense services in emergency situations.</p>
                <div class="mt-4 bg-gray-100 text-gray-700 py-1 px-3 rounded-full text-xs font-medium inline-block">
                    <i class="fas fa-search mr-1"></i> Find Now
                </div>
            </div>
        </a>

        <!-- Service Type 6: Forces Headquarters -->
        <a href="{% url 'service_provider_directory' %}?service_type=forces_hq" class="group">
            <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 transform group-hover:-translate-y-2">
                <i class="fas fa-building text-4xl text-purple-500 mb-4 group-hover:scale-110 transition-transform duration-300"></i>
                <h3 class="text-lg font-semibold group-hover:text-purple-500 transition-colors duration-300">Forces Headquarters</h3>
                <p class="text-gray-600 mt-2 text-sm">Connect with central command and coordination centers.</p>
                <div class="mt-4 bg-purple-100 text-purple-600 py-1 px-3 rounded-full text-xs font-medium inline-block">
                    <i class="fas fa-search mr-1"></i> Find Now
                </div>
            </div>
        </a>

        <!-- Service Type 7: Emergency Response Unit -->
        <a href="{% url 'service_provider_directory' %}?service_type=emergency_response" class="group">
            <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 transform group-hover:-translate-y-2">
                <i class="fas fa-exclamation-triangle text-4xl text-yellow-500 mb-4 group-hover:scale-110 transition-transform duration-300"></i>
                <h3 class="text-lg font-semibold group-hover:text-yellow-500 transition-colors duration-300">Emergency Response Units</h3>
                <p class="text-gray-600 mt-2 text-sm">Specialized emergency response teams and disaster management units.</p>
                <div class="mt-4 bg-yellow-100 text-yellow-600 py-1 px-3 rounded-full text-xs font-medium inline-block">
                    <i class="fas fa-search mr-1"></i> Find Now
                </div>
            </div>
        </a>

        <!-- Service Type 8: Others -->
        <a href="{% url 'service_provider_directory' %}?service_type=others" class="group">
            <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 transform group-hover:-translate-y-2">
                <i class="fas fa-ellipsis-h text-4xl text-indigo-500 mb-4 group-hover:scale-110 transition-transform duration-300"></i>
                <h3 class="text-lg font-semibold group-hover:text-indigo-500 transition-colors duration-300">Other Services</h3>
                <p class="text-gray-600 mt-2 text-sm">Additional emergency and support services in your area.</p>
                <div class="mt-4 bg-indigo-100 text-indigo-600 py-1 px-3 rounded-full text-xs font-medium inline-block">
                    <i class="fas fa-search mr-1"></i> Find Now
                </div>
            </div>
        </a>
    </div>

    <div class="text-center">
        <a href="{% url 'service_provider_directory' %}" class="bg-custom-red text-white py-3 px-8 rounded-full shadow-lg hover:bg-red-700 transition duration-300 font-semibold">
            <i class="fas fa-search mr-2"></i> Browse All Providers
        </a>
    </div>
</section>


        <!-- Role Card 2: Service Provider -->
<div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center text-center">
    <i class="fas fa-hospital text-4xl text-green-500 mb-4"></i>
    <h3 class="text-xl font-semibold text-gray-800 mb-2">Service Provider</h3>
    <p class="text-gray-600 text-sm flex-grow">Emergency services, hospitals, fire stations, and police. Manage alerts and coordinate emergency responses.</p>

    {% if user.is_authenticated and user.user_type == 'service_provider' %}
        <div class="mt-4 space-y-2 w-full">
            <a href="{% url 'service_provider_dashboard' %}" class="block bg-green-500 text-white py-2 px-6 rounded-full shadow-lg hover:bg-green-600 transition duration-300 font-semibold">Access Dashboard</a>
            <a href="{% url 'disasters:nearby_disasters' %}" class="block bg-blue-500 text-white py-2 px-6 rounded-full shadow-lg hover:bg-blue-600 transition duration-300 font-semibold text-sm">Nearby Emergencies</a>
        </div>
    {% else %}
        <a href="{% url 'register_service_provider' %}" class="mt-4 bg-green-500 text-white py-2 px-6 rounded-full shadow-lg hover:bg-green-600 transition duration-300 font-semibold">Register Organization</a>
    {% endif %}
</div>


        <!-- Emergency Services Directory Section - Added -->
        <section class="container mx-auto px-6 py-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900">Emergency Services Directory</h2>
                <p class="mt-2 text-gray-600">Quick access to essential emergency service numbers and contact details.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Service Card 1: Fire Service -->
                <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center text-center">
                    <i class="fas fa-fire-extinguisher text-4xl text-custom-red mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Fire Service</h3>
                    <p class="text-gray-600 text-sm flex-grow">Report fire incidents and get immediate assistance.</p>
                    <a href="tel:999" class="mt-4 bg-custom-red text-white py-2 px-6 rounded-full shadow-lg hover:bg-red-700 transition duration-300 font-semibold">Call 999</a>
                </div>
                <!-- Service Card 2: Police -->
                <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center text-center">
                    <i class="fas fa-users-cog text-4xl text-blue-500 mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Police</h3>
                    <p class="text-gray-600 text-sm flex-grow">Report crimes, accidents, and suspicious activities.</p>
                    <a href="tel:100" class="mt-4 bg-blue-500 text-white py-2 px-6 rounded-full shadow-lg hover:bg-blue-600 transition duration-300 font-semibold">Call 100</a>
                </div>
                <!-- Service Card 3: Medical -->
                <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center text-center">
                    <i class="fas fa-ambulance text-4xl text-green-500 mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Medical Emergency</h3>
                    <p class="text-gray-600 text-sm flex-grow">Request ambulance services and medical aid.</p>
                    <a href="tel:102" class="mt-4 bg-green-500 text-white py-2 px-6 rounded-full shadow-lg hover:bg-green-600 transition duration-300 font-semibold">Call 102</a>
                </div>
            </div>
        </section>

         <!-- Role-Based Emergency Access Section - Added -->
        <section class="container mx-auto px-6 py-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900">Role-Based Emergency Access</h2>
                <p class="mt-2 text-gray-600">Secure access to critical information based on your user role.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Role Card 1: Citizen -->
                <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center text-center">
                    <i class="fas fa-user-friends text-4xl text-custom-red mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Citizen</h3>
                    <p class="text-gray-600 text-sm flex-grow">Receive timely and relevant alerts based on your location and preferences. Report incidents easily.</p>
                    <a href="#" class="mt-4 bg-custom-red text-white py-2 px-6 rounded-full shadow-lg hover:bg-red-700 transition duration-300 font-semibold">Access Portal</a>
                </div>
                <!-- Role Card 2: Responder -->
                <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center text-center">
                    <i class="fas fa-user-shield text-4xl text-blue-500 mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Responder</h3>
                    <p class="text-gray-600 text-sm flex-grow">Get critical incident details, dispatch information, and real-time coordination tools.</p>
                    <a href="#" class="mt-4 bg-blue-500 text-white py-2 px-6 rounded-full shadow-lg hover:bg-blue-600 transition duration-300 font-semibold">Access Portal</a>
                </div>
                <!-- Role Card 3: Administrator -->
                <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center text-center">
                    <i class="fas fa-user-cog text-4xl text-green-500 mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Administrator</h3>
                    <p class="text-gray-600 text-sm flex-grow">Manage alerts, monitor system performance, and analyze data to improve emergency response.</p>
                    <a href="#" class="mt-4 bg-green-500 text-white py-2 px-6 rounded-full shadow-lg hover:bg-green-600 transition duration-300 font-semibold">Access Portal</a>
                </div>
            </div>
        </section>

        <!-- Security Section -->
        <section class="container mx-auto px-6 py-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900">Security & Privacy Assurance</h2>
                <p class="mt-2 text-gray-600">Your data is safe and secure with us. We use advanced encryption and security protocols.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Security Features</h3>
                    <ul class="space-y-4">
                        <li class="flex items-start space-x-3">
                            <i class="fas fa-check-circle text-green-500 mt-1"></i>
                            <div>
                                <h4 class="font-semibold">Secure Data Transfer</h4>
                                <p class="text-gray-600 text-sm">All data is encrypted in transit and at rest using industry-standard protocols.</p>
                            </div>
                        </li>
                        <li class="flex items-start space-x-3">
                            <i class="fas fa-check-circle text-green-500 mt-1"></i>
                            <div>
                                <h4 class="font-semibold">2-Factor Authentication</h4>
                                <p class="text-gray-600 text-sm">Add an extra layer of security to your account with 2FA.</p>
                            </div>
                        </li>
                        <li class="flex items-start space-x-3">
                            <i class="fas fa-check-circle text-green-500 mt-1"></i>
                            <div>
                                <h4 class="font-semibold">Privacy Policy</h4>
                                <p class="text-gray-600 text-sm">We are committed to protecting your privacy. Read our detailed policy.</p>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Our Commitment</h3>
                    <p class="text-gray-600 mb-6">We ensure your personal data is handled with the utmost care and professionalism.</p>
                    <div class="flex items-center justify-between">
                        <div class="text-center">
                            <i class="fas fa-shield-alt text-4xl text-custom-red mb-2"></i>
                            <p class="font-semibold">Advanced Encryption</p>
                        </div>
                        <div class="text-center">
                            <i class="fas fa-lock text-4xl text-blue-500 mb-2"></i>
                            <p class="font-semibold">Data Privacy</p>
                        </div>
                        <div class="text-center">
                            <i class="fas fa-user-shield text-4xl text-green-500 mb-2"></i>
                            <p class="font-semibold">System Security</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
        <!-- Alert Notifications (if user is logged in) -->
    <!--{% if user.is_authenticated and user.user_type == 'citizen' %}
       <div id="alertNotifications1" class="fixed top-20 right-4 space-y-2 z-50" style="display: none;">
            <-- Alerts will be populated via JavaScript ->
        </div>
    {% endif %}-->

    {% if user.is_authenticated or user.user_type == 'service_provider' or user.user_type == 'citizen' %}
        <div id="alertNotifications" class="fixed top-20 right-4 space-y-2 z-50" style="display: none;">
            <!-- Alerts will be populated via JavaScript -->
        </div>
    {% endif %}
    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-300 py-12">
        <div class="container mx-auto px-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
            <div>
                <h3 class="text-lg font-bold text-white mb-4">ERAS</h3>
                <p class="text-sm">Providing real-time emergency alerts and vital community services to keep you safe.</p>
            </div>
            <div>
                <h3 class="text-lg font-bold text-white mb-4">Quick Links</h3>
                <ul class="text-sm space-y-2">
                    <li><a href="#" class="hover:text-white transition duration-300">Home</a></li>
                    <li><a href="{% url 'about_us' %}" class="hover:text-white transition duration-300">About Us</a></li>
                    <li><a href="#" class="hover:text-white transition duration-300">Services</a></li>
                    <li><a href="#" class="hover:text-white transition duration-300">Contact</a></li>
                </ul>
            </div>
            <div>
                <h3 class="text-lg font-bold text-white mb-4">Support</h3>
                <ul class="text-sm space-y-2">
                    <li><a href="#" class="hover:text-white transition duration-300">FAQ</a></li>
                    <li><a href="#" class="hover:text-white transition duration-300">Help Center</a></li>
                    <li><a href="#" class="hover:text-white transition duration-300">Privacy Policy</a></li>
                    <li><a href="#" class="hover:text-white transition duration-300">Terms of Service</a></li>
                </ul>
            </div>
            <div>
                <h3 class="text-lg font-bold text-white mb-4">Follow Us</h3>
                <div class="flex space-x-4">
                    <a href="#" class="text-gray-400 hover:text-white transition duration-300"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="text-gray-400 hover:text-white transition duration-300"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="text-gray-400 hover:text-white transition duration-300"><i class="fab fa-linkedin-in"></i></a>
                    <a href="#" class="text-gray-400 hover:text-white transition duration-300"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
        </div>
        <div class="text-center mt-8 border-t border-gray-700 pt-6 text-sm">
            &copy; 2025 Emergency Response & Alert System. All Rights Reserved.
        </div>
    </footer>
<script>
    {% if user.is_authenticated or user.user_type == 'service_provider' or user.user_type == 'citizen' %}
        // Notification system
        async function checkForAlerts() {
            try {
                const response = await fetch('{% url "disasters:user_alerts" %}');
                const data = await response.json();

                if (data.alerts && data.alerts.length > 0) {
                    showAlertNotifications(data.alerts);
                }
            } catch (error) {
                console.error('Error checking alerts:', error);
            }
        }

        function showAlertNotifications(alerts) {
            const container = document.getElementById('alertNotifications');
            container.innerHTML = '';

            alerts.slice(0, 3).forEach(alert => { // Show max 3 alerts
                const alertDiv = document.createElement('div');
                alertDiv.className = 'bg-red-500 text-white p-4 rounded-lg shadow-lg max-w-sm transform translate-x-full transition-transform duration-300';
                alertDiv.innerHTML = `
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="font-bold text-sm mb-1">${alert.disaster_type} - ${alert.severity.toUpperCase()}</div>
                            <div class="text-xs mb-2">${alert.location}</div>
                            <div class="text-xs opacity-90">${alert.description}</div>
                        </div>
                        <button onclick="dismissAlert(this, ${alert.id})" class="ml-2 text-white hover:text-gray-200">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="mt-3 flex justify-between items-center">
                        <span class="text-xs opacity-75">${alert.time_reported}</span>
                        <a href="/disasters/${alert.disaster_id}/"
                           class="bg-white text-red-500 px-3 py-1 rounded text-xs font-medium hover:bg-gray-100 transition-colors">
                            View
                        </a>
                    </div>
                `;

                container.appendChild(alertDiv);
                container.style.display = 'block';

                // Animate in
                setTimeout(() => {
                    alertDiv.classList.remove('translate-x-full');
                }, 100);

                // Auto-dismiss after 10 seconds
                setTimeout(() => {
                    dismissAlert(alertDiv, alert.id);
                }, 10000);
            });
        }

        async function dismissAlert(element, alertId) {
            const alertDiv = element.closest ? element.closest('div') : element;

            // Mark as read
            try {
                await fetch(`{% url 'disasters:mark_alert_read' 0 %}`.replace('0', alertId), {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]')?.value || '',
                        'Content-Type': 'application/json',
                    }
                });
            } catch (error) {
                console.error('Error marking alert as read:', error);
            }

            // Animate out
            alertDiv.classList.add('translate-x-full');
            setTimeout(() => {
                alertDiv.remove();

                // Hide container if no more alerts
                const container = document.getElementById('alertNotifications');
                if (container.children.length === 0) {
                    container.style.display = 'none';
                }
            }, 300);
        }
    // Check for alerts when page loads and every minute
        document.addEventListener('DOMContentLoaded', () => {
            checkForAlerts();
            setInterval(checkForAlerts, 60000); // Check every minute
        });
        {% endif %}

    // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenu = document.getElementById('mobileMenu');

        mobileMenuBtn.addEventListener('click', function() {
            mobileMenuBtn.classList.toggle('active');
            mobileMenu.classList.toggle('active');
        });

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const isClickInsideNav = event.target.closest('nav');
            if (!isClickInsideNav && mobileMenu.classList.contains('active')) {
                mobileMenuBtn.classList.remove('active');
                mobileMenu.classList.remove('active');
            }
        });

        // Close mobile menu when window is resized to desktop size
        window.addEventListener('resize', function() {
            if (window.innerWidth >= 768 && mobileMenu.classList.contains('active')) {
                mobileMenuBtn.classList.remove('active');
                mobileMenu.classList.remove('active');
            }
        });

</script>
</body>
</html>